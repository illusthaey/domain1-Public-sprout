<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="color-scheme" content="light" />
  <title>출입문개폐전담원 월별 인건비 지출서식</title>

  <link rel="icon" href="/static/favicon.ico" />
  <link rel="stylesheet" href="/static/style.css" />

  <style>
    /* 페이지 전용 보강 (기존 /static/style.css 유지) */
    .hint { font-size: 0.95rem; color: #555; margin-top: 6px; }
    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background:#f3f4f6; padding:2px 6px; border-radius:6px; border:1px solid #e5e7eb; }
    .calendar-layout { display: grid; grid-template-columns: 2fr 1fr; gap: 12px; }
    @media (max-width: 640px) { .calendar-layout { grid-template-columns: 1fr; } }

    .cal-cell { min-height: 78px; display:flex; flex-direction:column; gap:6px; }
    .cal-date { font-weight: 700; color:#111; font-size: 0.95rem; }
    .cal-mark { width: 100%; padding: 8px 10px; border-radius: 10px; border: 1px solid #d9d9e3; background: #f9fafb; }
    .cal-mark:focus { border-color:#b4b4d0; background:#fff; box-shadow: 0 0 0 2px rgba(180,180,208,0.25); outline:none; }
    .cal-empty { background:#fafafa; color:#aaa; }
    .num { text-align: right; }

    /* PDF 캡처용 영역(시각적 여백 안정화) */
    .pdf-page {
      background: #fff;
      padding: 10px;
      border: 1px solid #e5e7eb;
      border-radius: 12px;
    }
    .pdf-title {
      font-size: 1.2rem;
      font-weight: 800;
      text-align: center;
      margin: 6px 0 12px;
      color: #111;
    }

    .tiny { font-size: 0.9rem; color:#444; }
    .mono { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; }
    .right { text-align:right; }
  </style>
</head>

<body>
  <div class="home-link-wrap">
    <a class="btn-home" href="/">← 메인으로</a>
  </div>

  <main class="container">
    <h1>출입문개폐전담원 월별 인건비 지출서식</h1>
    <p class="subtitle">출근내역(달력) + 인건비 산정 + 임금명세서 + 엑셀(3시트) + PDF 저장</p>

    <section class="section">
      <h2 class="local-h2">1) 기본정보</h2>
      <hr/>
      <div class="grid two">
        <div class="field">
          <label class="muted">학교명(소속)</label><br/>
          <input id="schoolName" type="text" placeholder="예: 문막초" />
        </div>

        <div class="field">
          <label class="muted">문서번호/비고(선택)</label><br/>
          <input id="docNo" type="text" placeholder='예: 문막초-1928(2025.2.21.) "근로계약 체결"' />
        </div>

        <div class="field">
          <label class="muted">지급월</label><br/>
          <input id="payMonth" type="month" />
        </div>

        <div class="field">
          <label class="muted">지급일자</label><br/>
          <input id="payDate" type="date" />
        </div>

        <div class="field">
          <label class="muted">성명</label><br/>
          <input id="workerName" type="text" placeholder="예: 홍길동" />
        </div>

        <div class="field">
          <label class="muted">직종</label><br/>
          <input id="jobTitle" type="text" value="출입문개폐전담원" />
        </div>

        <div class="field">
          <label class="muted">생년월일</label><br/>
          <input id="birthDate" type="date" />
        </div>

        <div class="field">
          <label class="muted">최초임용일</label><br/>
          <input id="firstHireDate" type="date" />
        </div>
      </div>
    </section>

    <section class="section">
      <h2 class="local-h2">2) 단가 · 근무시간대(요일별)</h2>
      <hr/>

      <div class="grid two">
        <div class="card">
          <div class="row between">
            <div>
              <div class="muted">시급(원)</div>
              <input id="hourlyRate" type="number" class="numeric" min="0" step="10" />
              <div class="hint">
                ·기본 11,500원(2026 기준) / 2025 기준은 11,200원<br/>
                ·금액 계산은 “원단위 절삭(1의 자리 제거)” 규칙 적용(예: 1111 → 1110)
              </div>
            </div>
            <div style="text-align:right;">
              <button class="btn" id="btnSet2025" type="button">2025 단가(11,200)</button>
              <button class="btn" id="btnSet2026" type="button">2026 단가(11,500)</button>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="muted">편의 기능</div>
          <div class="row gap" style="flex-wrap:wrap; margin-top:8px;">
            <button class="btn" id="btnPresetMoonmak" type="button">문막초 예시 시간대 적용</button>
            <label class="row" style="gap:8px;">
              <input id="chkMonThuSame" type="checkbox" />
              <span class="muted">월 변경 시 화~목 자동 복사(월~목 동일 패턴)</span>
            </label>
            <button class="btn" id="btnCopyMonToTueThu" type="button">월→화~목 한 번 복사</button>
          </div>
          <div class="hint">
            ·셀(표 안 입력칸)에서 <span class="kbd">↑</span><span class="kbd">↓</span><span class="kbd">←</span><span class="kbd">→</span> 로 이동 가능<br/>
            ·셀 안에서 커서 이동은 “끝/처음”에서만 다음 셀로 넘어가도록 처리(엑셀 느낌)
          </div>
        </div>
      </div>

      <div class="card">
        <div class="muted">요일별 근무시간대</div>
        <div class="table-wrap">
          <table class="sheetlike" id="scheduleTable">
            <thead>
              <tr>
                <th style="width:72px;">요일</th>
                <th>1차 시작</th>
                <th>1차 종료</th>
                <th>2차 시작</th>
                <th>2차 종료</th>
                <th style="width:140px;">1일 근로시간(자동)</th>
              </tr>
            </thead>
            <tbody id="scheduleTbody"></tbody>
            <tfoot>
              <tr>
                <th colspan="5" class="right">주(요일패턴) 합계</th>
                <th class="right"><span id="weeklyHours" class="mono">0</span> 시간</th>
              </tr>
            </tfoot>
          </table>
        </div>
        <div class="hint">
          ·시간이 비어있으면 0시간으로 처리합니다.<br/>
          ·월~목 3시간, 금 2시간 패턴이면 주 14시간으로 자동 계산됩니다.
        </div>
      </div>
    </section>

    <section class="section">
      <h2 class="local-h2">3) 엑셀 업로드/다운로드 · 저장</h2>
      <hr/>

      <div class="card">
        <div class="row gap" style="flex-wrap:wrap;">
          <button class="btn primary" id="btnDownloadTemplate" type="button">업로드용 입력서식 다운로드(.xlsx)</button>

          <label class="btn" style="display:inline-flex; align-items:center; gap:10px;">
            엑셀 업로드(.xlsx)
            <input id="excelUpload" type="file" accept=".xlsx,.xls" style="display:none;" />
          </label>

          <button class="btn primary" id="btnExportXlsx" type="button">엑셀로 저장(3시트 .xlsx)</button>
          <button class="btn primary" id="btnExportPdf" type="button">PDF로 저장(.pdf)</button>

          <button class="btn" id="btnReset" type="button">초기화(로컬저장 포함)</button>
        </div>

        <div class="hint">
          ·업로드 서식은 이 페이지에서 다운로드한 “입력서식”을 기준으로 자동 채움 됩니다.<br/>
          ·외부에서 만든 엑셀도 최대한 읽으려 시도하지만, 100% 보장은 못합니다(서식이 제각각이라… 우주가 문제임).<br/>
          ·엑셀/PDF 저장은 **브라우저에서만** 처리됩니다(서버 업로드 없음).
        </div>
      </div>
    </section>

    <section class="section">
      <h2 class="local-h2">4) 출근내역(달력)</h2>
      <hr/>

      <div class="card">
        <div class="row between" style="flex-wrap:wrap;">
          <div class="row gap" style="flex-wrap:wrap;">
            <button class="btn" id="btnPrevMonth" type="button">← 이전달</button>
            <button class="btn" id="btnNextMonth" type="button">다음달 →</button>
          </div>

          <div class="row gap" style="flex-wrap:wrap; justify-content:flex-end;">
            <button class="btn" id="btnAutoFillBlank" type="button">근무일 자동채우기(빈칸만)</button>
            <button class="btn" id="btnAutoFillOverwrite" type="button">근무일 자동채우기(전체덮어쓰기)</button>
            <button class="btn" id="btnClearMarks" type="button">달력 표기 전체 지우기</button>
          </div>
        </div>

        <div class="hint">
          ·달력 칸에는 <span class="kbd">O</span> 또는 <span class="kbd">휴가</span>/<span class="kbd">연휴</span>/<span class="kbd">공휴일</span> 같이 표기합니다.<br/>
          ·기본 산정은 <span class="kbd">O</span> 인 날만 유급 근로시간으로 계산합니다.
        </div>
      </div>

      <datalist id="markList">
        <option value="O"></option>
        <option value="휴가"></option>
        <option value="연휴"></option>
        <option value="공휴일"></option>
        <option value="출장"></option>
        <option value="교육"></option>
        <option value="병가"></option>
      </datalist>

      <div class="calendar-layout">
        <div class="card">
          <div class="table-wrap">
            <table class="sheetlike" id="calendarTable">
              <thead>
                <tr>
                  <th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th>
                </tr>
              </thead>
              <tbody id="calendarTbody"></tbody>
            </table>
          </div>
        </div>

        <div class="card">
          <div class="muted">당월 산정 요약</div>
          <div class="table-wrap">
            <table class="sheetlike">
              <tbody>
                <tr><th>당월 근무일수(월~목)</th><td class="num"><span id="cntMonThu">0</span> 일</td></tr>
                <tr><th>당월 근무일수(금)</th><td class="num"><span id="cntFri">0</span> 일</td></tr>
                <tr><th>당월 유급 근로시간</th><td class="num"><span id="totalHours">0</span> 시간</td></tr>
                <tr><th>시급</th><td class="num"><span id="viewHourly">0</span> 원</td></tr>
                <tr><th>당월 보수 지급액(기본급)</th><td class="num"><span id="basePayView">0</span> 원</td></tr>
              </tbody>
            </table>
          </div>
          <div class="hint tiny">
            ·월~목/금 구분은 “문막초 예시 양식” 호환용으로 함께 보여줍니다.<br/>
            ·요일별 시간이 다르면, 실제 합계는 달력+시간대 기준으로 정확히 계산됩니다.
          </div>
        </div>
      </div>
    </section>

    <section class="section">
      <h2 class="local-h2">5) 사회보험료 개인부담금(공제) · 임금명세서 계산</h2>
      <hr/>

      <div class="grid two">
        <div class="card">
          <div class="muted">사회보험료(개인부담) — 기본값: 미공제</div>
          <div class="hint tiny">
            ·요율은 매년 변경될 수 있어 **수정 가능**하게 열어뒀습니다.<br/>
            ·자동 산출값/수기 입력값 모두 “원단위 절삭(1의 자리 제거)” 적용
          </div>

          <div style="margin-top:10px;">
            <label class="row" style="gap:8px; align-items:center;">
              <input id="healthEnabled" type="checkbox" />
              <span><b>국민건강(요양포함)</b> 공제</span>
            </label>

            <div class="grid three" style="margin-top:10px;">
              <div class="field">
                <label class="muted">건강보험료율(%)</label><br/>
                <input id="healthRate" type="number" step="0.01" />
              </div>
              <div class="field">
                <label class="muted">요양보험료율(%)</label><br/>
                <input id="ltcRate" type="number" step="0.01" />
              </div>
              <div class="field">
                <label class="muted">자동산출</label><br/>
                <select id="healthAuto">
                  <option value="Y">자동</option>
                  <option value="N">수기</option>
                </select>
              </div>
            </div>

            <div class="field" style="margin-top:10px;">
              <label class="muted">공제금액(원) — 건강+요양 합산</label><br/>
              <input id="healthAmount" type="number" class="numeric" step="10" />
              <div class="hint tiny">표시 참고: 건강(개인) + 요양(개인) = 합산 공제</div>
            </div>
          </div>

          <hr/>

          <div>
            <label class="row" style="gap:8px; align-items:center;">
              <input id="empEnabled" type="checkbox" />
              <span><b>고용보험(개인부담)</b> 공제</span>
            </label>

            <div class="grid three" style="margin-top:10px;">
              <div class="field">
                <label class="muted">개인요율(%)</label><br/>
                <input id="empRate" type="number" step="0.01" />
              </div>
              <div class="field">
                <label class="muted">자동산출</label><br/>
                <select id="empAuto">
                  <option value="Y">자동</option>
                  <option value="N">수기</option>
                </select>
              </div>
              <div class="field">
                <label class="muted">공제금액(원)</label><br/>
                <input id="empAmount" type="number" class="numeric" step="10" />
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="muted">기타 공제(선택)</div>
          <div class="hint tiny">임금명세서 모양 맞추려고 넣었습니다. 필요 없으면 0으로 두면 됩니다.</div>

          <div class="grid two" style="margin-top:10px;">
            <div class="field">
              <label class="muted">소득세(원)</label><br/>
              <input id="incomeTax" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">주민세(원)</label><br/>
              <input id="localTax" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">국민연금(원)</label><br/>
              <input id="pension" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">기타공제(원)</label><br/>
              <input id="etcDed" type="number" class="numeric" step="10" />
            </div>
          </div>

          <hr/>

          <div class="muted">기타 수당(선택)</div>
          <div class="grid two" style="margin-top:10px;">
            <div class="field">
              <label class="muted">근속수당(원)</label><br/>
              <input id="allowSeniority" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">정액급식비(원)</label><br/>
              <input id="allowMeal" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">위험근무수당(원)</label><br/>
              <input id="allowDanger" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">면허가산수당(원)</label><br/>
              <input id="allowLicense" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">특수업무수당(원)</label><br/>
              <input id="allowSpecial" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">급식운영수당(원)</label><br/>
              <input id="allowMealOps" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">가족수당(원)</label><br/>
              <input id="allowFamily" type="number" class="numeric" step="10" />
            </div>
            <div class="field">
              <label class="muted">명절휴가비(원) (부정기)</label><br/>
              <input id="allowHolidayBonus" type="number" class="numeric" step="10" />
            </div>
          </div>
        </div>
      </div>

      <div class="card">
        <div class="muted">산정 결과</div>
        <div class="table-wrap">
          <table class="sheetlike">
            <tbody>
              <tr><th>급여총액 계 (A)</th><td class="num"><span id="sumA">0</span> 원</td></tr>
              <tr><th>공제액 계 (B)</th><td class="num"><span id="sumB">0</span> 원</td></tr>
              <tr><th>실수령액 (A-B)</th><td class="num"><b><span id="netPay">0</span> 원</b></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </section>

    <section class="section">
      <h2 class="local-h2">6) 임금명세서 미리보기(PDF/엑셀 Sheet3 출력 내용)</h2>
      <hr/>

      <div id="pdfPage2" class="pdf-page">
        <div class="pdf-title" id="stubTitle">임금명세서</div>

        <div class="table-wrap">
          <table class="sheetlike">
            <tbody>
              <tr>
                <th style="width:120px;">소속</th>
                <td id="stubSchool"></td>
                <th style="width:120px;">지급일</th>
                <td id="stubPayDate"></td>
              </tr>
              <tr>
                <th>성명</th>
                <td id="stubName"></td>
                <th>직종</th>
                <td id="stubJob"></td>
              </tr>
              <tr>
                <th>생년월일</th>
                <td id="stubBirth"></td>
                <th>최초임용일</th>
                <td id="stubFirstHire"></td>
              </tr>
            </tbody>
          </table>
        </div>

        <div class="grid two" style="margin-top:12px;">
          <div class="table-wrap">
            <table class="sheetlike">
              <thead>
                <tr><th colspan="3">급여내역</th></tr>
                <tr><th style="width:90px;">구분</th><th>임금항목</th><th style="width:150px;">금액</th></tr>
              </thead>
              <tbody id="payItemsTbody"></tbody>
              <tfoot>
                <tr><th colspan="2">급여총액 계 (A)</th><th class="num" id="stubSumA">0</th></tr>
              </tfoot>
            </table>
          </div>

          <div class="table-wrap">
            <table class="sheetlike">
              <thead>
                <tr><th colspan="3">공제내역</th></tr>
                <tr><th style="width:90px;">구분</th><th>항목</th><th style="width:150px;">금액</th></tr>
              </thead>
              <tbody id="dedTbody"></tbody>
              <tfoot>
                <tr><th colspan="2">공제액 계 (B)</th><th class="num" id="stubSumB">0</th></tr>
              </tfoot>
            </table>
          </div>
        </div>

        <div class="table-wrap" style="margin-top:12px;">
          <table class="sheetlike">
            <tbody>
              <tr><th>실수령액 (A-B)</th><td class="num"><b id="stubNet">0</b></td></tr>
            </tbody>
          </table>
        </div>

        <div class="hint tiny">
          ·PDF 저장은 위 “임금명세서 미리보기” + “출근내역(달력)”을 2페이지로 묶어서 출력합니다.
        </div>
      </div>
    </section>

    <section class="section">
      <h2 class="local-h2">7) PDF 1페이지(출근내역 + 산정요약) 미리보기</h2>
      <hr/>

      <div id="pdfPage1" class="pdf-page">
        <div class="pdf-title" id="attTitle">출근내역 및 인건비 산정 내역</div>

        <div class="grid two">
          <div class="table-wrap">
            <table class="sheetlike">
              <tbody>
                <tr><th style="width:120px;">학교</th><td id="attSchool"></td></tr>
                <tr><th>성명</th><td id="attName"></td></tr>
                <tr><th>시급</th><td class="num" id="attHourly"></td></tr>
                <tr><th>근로시간(주)</th><td class="num"><span id="attWeeklyHours">0</span> 시간</td></tr>
              </tbody>
            </table>
          </div>

          <div class="table-wrap">
            <table class="sheetlike">
              <tbody>
                <tr><th>당월 근무일수(월~목)</th><td class="num"><span id="attCntMonThu">0</span></td></tr>
                <tr><th>당월 근무일수(금)</th><td class="num"><span id="attCntFri">0</span></td></tr>
                <tr><th>당월 유급 근로시간</th><td class="num"><span id="attTotalHours">0</span></td></tr>
                <tr><th>당월 보수 지급액</th><td class="num"><b id="attBasePay">0</b></td></tr>
              </tbody>
            </table>
          </div>
        </div>

        <div class="hint tiny" id="attScheduleText"></div>

        <div class="table-wrap" style="margin-top:10px;">
          <table class="sheetlike">
            <thead>
              <tr>
                <th>일</th><th>월</th><th>화</th><th>수</th><th>목</th><th>금</th><th>토</th>
              </tr>
            </thead>
            <tbody id="pdfCalendarTbody"></tbody>
          </table>
        </div>

        <div class="hint tiny">
          ·PDF는 “달력 표기” 내용을 그대로 찍습니다(입력창처럼 보이면, 저장 전에 확대/축소 100% 권장).
        </div>
      </div>
    </section>

  </main>

  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>

  <script src="app.js"></script>

  <script src="/static/disable-copy.js"></script>
  <script src="/static/footer.js"></script>
  <script src="/static/global-loader.js?v=1"></script>
</body>
</html>
